pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
-- heli
-- by mario zoth 

function update_timer()
	timer.frames += 1
	if timer.frames == 60 then
		timer.frames = 0
		timer.seconds += 1
	end
	if timer.seconds == 60 then
		timer.seconds = 0
		timer.minutes += 1
	end
	if timer.minutes == 60 then
		timer.minutes = 0
	end
	timer_display = timer.minutes..":"..timer.seconds..":"..timer.frames	
end

function update_start()
	if btn(5) then
		_update=update_game
		_draw=draw_game
	end
end

function draw_start()
	cls()
	print("press x to start",40,60,7)
end

function update_heli()
 if timer.frames%2 == 0 then
 	if heli.snum == 0 then
 		heli.snum = 1
 	else
 		heli.snum = 0
 	end
	end
			
	for shot in all(heli.shots) do
		shot.y-=2
	end
	
	for shot in all(heli.shots) do
		if (shot.y < 0) del(heli.shots,shot)
	end
	
	for shot in all(heli.shots) do
		for enemy in all(enemies) do
			
			if enemy.y+8 >= shot.y
					and enemy.y <= shot.y
					and enemy.x <= shot.x
					and enemy.x+8 >= shot.x then
				del(enemies,enemy)
			end
			
		end
	end
	
	if btnp(5) then
		add(heli.shots, {x=heli.x+4,y=heli.y})
	end
end

function draw_heli()
	spr(heli.snum,heli.x,heli.y,1,1)
	
	if not heli.snd then
		sfx(1)
		heli.snd=true
	end
	
	for shot in all(heli.shots) do
		rectfill(shot.x,shot.y,shot.x,shot.y,7)
	end
end

function update_enemies()
	for enemy in all(enemies) do
		if enemy.snum == 0 then
			enemy.snum = 1
		else
			enemy.snum = 0
		end
		enemy.y+=1
		
		if enemy.y+8 >= heli.y
					and enemy.y <= heli.y+8
					and enemy.x <= heli.x+8
					and enemy.x+8 >= heli.x then
			enemy.coll=true
			sfx(0,1)
		end
		
 	for enemy in all(enemies) do
 		if (enemy.y+8 > 127) del(enemies,enemy)
 	end
 	
	end
end

function draw_ememies()
	for enemy in all(enemies) do
		spr(enemy.snum,enemy.x,enemy.y,1,1,false,true)
	end
end

function update_game()
	update_timer()
	update_heli()
	update_enemies()
	
	if (btn(0)) heli.x = mid(-2,heli.x-1,121)
	if (btn(1)) heli.x = mid(-2,heli.x+1,121)
	if (btn(2)) heli.y = mid(0,heli.y-1,120)
	if (btn(3)) heli.y = mid(0,heli.y+1,120)
end

function draw_game()
	cls()
	rectfill(0,0,127,127,3)
	draw_heli()
	pal(1,2)
	draw_ememies()
	pal()
end

function _update()
end

function _draw()
	--print(timer_display,5,5,7)
end

function _init()
	timer = {
		frames = 0,
		seconds = 0,
		minutes = 0
	}
	
	heli = {
		snum = 0,
		x = 60,
		y = 60,
		snd=false,
		shots = {
			--{x=60,y=60}
		}
	}
	
	enemies = { 
		{snum=0,x=30,y=-8,coll=false}, 
		{snum=0,x=60,y=-8,coll=false}, 
		{snum=0,x=90,y=-8,coll=false}
	}
	
	_update = update_start
	_draw = draw_start
end
__gfx__
00071000070110700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00171100007117000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00177770001771000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07777100001771000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00117100007117000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00017000070110700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00011000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00111100001111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0505050505050505050505050505050505050505050505050505050505050505050505000000000000000000000000000000000000000505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505000000000000000000000000000000000005050505050505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050512000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050512000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050512000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050512000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050512000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050512000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050512000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
00030000380502f0502d0502d0502c0502c0500f0002630026300283002830029300293000e4000e4000e4000e4000e4000f4000f4001040010400104000f4000f4000f4000f4000f40000000000000000000000
010700021b625136001c005130000b005246002560025600246053560035600356003560035600356003560035600356003660000000376003860000000396003a6003a600000000000000000000000000000000
00100000146730d6730d6630d6530d6430d6330d6230d613095000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0004000015450134500f45005450024500d6000c60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000f00000d0200d0200d0200d020150201402014020140200e0200e0200e0200e0200e00000000000000d0000d0200d0200d0200d020150201402014020140200e0200e0200e0200e02000000000000000000000
000f00000d5200d5200d5200d520155201452014520145200e5200e5200e5200e520000000000000000000000d5200d5200d5200d520155201452014520145200e5200e5200e5200e52000000000000000000000
010f00001103311600000000000037623000000000011033110331100311033000003762300000000000000011033000000000000000376230000000000110331103300000110330000037623000003760300000
__music__
03 04050644

